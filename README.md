# ROS2 SLAM Workspace Setup & Simulation Launch Guide üõ†Ô∏èü§ñ

This guide will help you set up a ROS2 SLAM workspace, solve common installation errors, and launch a full simulation stack with QGroundControl, SLAM nodes, and Gazebo. It also provides troubleshooting tips and previews your TF tree.

---

## Table of Contents üìö

1. [Core Requirements](#core-requirements)
2. [Installation & Setup](#installation--setup)
3. [Common Errors & Fixes](#common-errors--fixes)
4. [Launching the Simulation](#launching-the-simulation)
5. [TF Tree Preview](#tf-tree-preview)
6. [Coming Soon](#coming-soon)

---

## Core Requirements üìù

- **OS:** Ubuntu 24.04 LTS Noble üêß
- **ROS2:** Jazzy 
- **Simulation:** Gazebo Harmonic  + RViz 



## Key Repositories for Setup Workspace !

Below are the main repositories referenced for installation ( improvements are comming !):

- [match-drone](https://github.com/rouuu2/match-drone)
- [PX4-Autopilot](https://github.com/PX4/PX4-Autopilot)
- [mavros](https://github.com/mavlink/mavros)
- [qgroundcontrol](https://github.com/mavlink/qgroundcontrol)
- [ros_gz (jazzy branch)](https://github.com/gazebosim/ros_gz/tree/jazzy)
- [Livox-SDK2](https://github.com/Livox-SDK/Livox-SDK2)
- [FAST-LIO2](https://github.com/hku-mars/FAST_LIO)

---

## Installation & Setup ‚öôÔ∏è

### 1. Prepare Your Environment üå±

- Install ROS2 Jazzy and Gazebo Harmonic (refer to the official ROS2 and Gazebo docs).
- Clone your workspace and initialize:
    ```bash
    mkdir -p ~/slam_ws/src
    cd ~/slam_ws/src
    # Clone your packages here, e.g.
    # git clone https://github.com/.... (Repo)
    ```

### 2. Create and Activate a Python Virtual Environment 

```bash
python3 -m venv ~/.../venv
source ~/.../venv/bin/activate
```

### 3. Install Python Requirements üì¶

- Edit `requirements.txt` to list only real Python packages (see [Common Errors & Fixes](#common-errors--fixes) below).
- Install dependencies:
    ```bash
    pip install -r ~/.../src/match-drone/setup/requirements.txt
    ```

### 4. Install System Tools üõ†Ô∏è

```bash
sudo apt update
sudo apt install pcl-tools
```

---

## Common Errors & Fixes üöß

### 1. `pcl_viewer` & `PCL` Installation Error ‚ùå

**Error:**
```
ERROR: Could not find a version that satisfies the requirement pcl_viewer (from versions: none)
ERROR: No matching distribution found for pcl_viewer
```

**Solution:**
- Remove or comment out `pcl_viewer` and `PCL` from your `requirements.txt` 
- Reinstall requirements and install system PCL tools as described above.

### 2. Cython Error During Build üêç‚öíÔ∏è

**Error:**
```
ModuleNotFoundError: No module named 'Cython'
```

**Solution:**
1. Install Cython in your virtual environment:
    ```bash
    pip install Cython
    ```
2. Prevent colcon from searching your venv:
    ```bash
    touch ~/../venv/COLCON_IGNORE
    ```
3. Rebuild your workspace:
    ```bash
    cd ~/...
    colcon build
    ```

---

## Checklist: Verifying Your Installation ‚úÖ

```bash
python3 --version     # Should show Python 3.12.x or your target version
pip check             # Should output: "No broken requirements found."
colcon build          # Should build the workspace without errors
```

---

## Launching the Simulation üöÄ

Follow these steps in order:

**1. Start QGroundControl üïπÔ∏è**
```bash
~/.../src$ ./QGroundControl-x86_64.AppImage
```
> _This launches the GCS for drone control and telemetry._

**2. Launch the SLAM Connector üîó**
```bash
ros2 launch slam_connect test.launch.py
```

**3. Launch Fast-LIO Mapping üó∫Ô∏è**
```bash
ros2 launch fast_lio mapping.launch.py \
    config_path:=/home/.../.../src/match-drone/slam_connect/config \
    config_file:=slam_params.yaml \
    rviz:=false
```
> _You can edit `slam_params.yaml` to change map/SLAM parameters._

**5. Control the Drone from QGroundControl üéÆ**
- Use QGroundControl for all manual control and mission upload.

**Remark:**  
_Keyboard control is **coming soon**! Stay tuned for updates in the parameter file to enable quick map switching and keyboard-based teleoperation._ ‚å®Ô∏è

---

## TF Tree Preview üå≥

Below is the current transform tree generated by your system (`tf2_tools view_frames`):


![frames_2025-10-20_19 17 52_page-0001](https://github.com/user-attachments/assets/6650c7d9-603c-4708-a161-224e366f7a78)


## Coming Soon ‚ú®
- **setup workspace:**
- **Keyboard Control:** Direct drone control via keyboard for quick development and testing 
- **Parameter File Enhancements:** Easily switch maps and configurations via new parameters 
- **Better Visualization:** Extended RViz and Gazebo integration for richer simulation feedback 

---
